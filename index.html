<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Stacja Jarocin</title>
    <style>
        /* --- BAZA --- */
        html, body {
            background-color: #000000;
            height: 100%;
            width: 100%;
            overflow: hidden;
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
            color: #ffffff;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding-top: 5vh;
            padding-bottom: 2vh;
            box-sizing: border-box;
        }

        /* --- PAPIE≈ª (JUMPSCARE + 21:37) --- */
        #random-pope-img {
            position: fixed; /* Zawsze na wierzchu */
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            object-fit: cover; /* Wype≈Çnia ca≈Çy ekran */
            display: none; /* Domy≈õlnie ukryty */
            z-index: 9999; /* Najwy≈ºsza warstwa */
            background-color: #ffcc00; /* ≈ª√≥≈Çte t≈Ço pod spodem */
        }

        /* --- G√ìRA (ZEGAR) --- */
        .main-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        #clock {
            font-size: 35vh; 
            font-weight: bold;
            line-height: 0.9;
            letter-spacing: -3px;
            margin: 0;
        }
        
        #date {
            font-size: 6vh;
            margin-top: 1vh;
            opacity: 0.8;
            font-weight: normal;
        }

        .current-weather {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2vh;
            margin-top: 5vh;
        }

        #weather-icon { font-size: 12vh; }
        #weather-text { font-size: 10vh; font-weight: bold; color: #ffcc00; }

        /* --- D√ì≈Å (PROGNOZA) --- */
        .forecast-container {
            width: 98%;
            display: flex;
            justify-content: center;
            gap: 1vw;
            align-items: flex-end;
        }

        .day-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 13vw;
        }

        .day-name { font-size: 3.5vh; margin-bottom: 0.5vh; font-weight: bold; }
        .day-icon { font-size: 5vh; margin-bottom: 0.5vh; }
        .day-temp { font-size: 3.5vh; font-weight: bold; }
        .day-temp span { color: #dddddd; font-weight: normal; font-size: 0.8em; margin-left: 3px; }

    </style>
</head>
<body>

    <img id="random-pope-img" src="https://images.genius.com/7608922986c65480eac7bf1174833542.200x230x7.gif" alt="JP2">

    <div class="main-content">
        <div id="clock">00:00</div>
        <div id="date">...</div>
        
        <div class="current-weather">
            <div id="weather-icon">‚è≥</div>
            <div id="weather-text">Jarocin: --¬∞</div> 
        </div>
    </div>

    <div class="forecast-container" id="forecast-row">
        </div>

    <script>
        // --- PE≈ÅNY EKRAN ---
        document.body.addEventListener('click', function() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(e => console.log(e));
            }
        });

        // Zmienna pomocnicza, ≈ºeby wiedzieƒá, czy trwa "godzina papieska"
        let isPapalTime = false; 

        // ==================================================
        // --- LOGIKA LOSOWEGO PAPIE≈ªA (JUMPSCARE) ---
        // ==================================================
        
        function scheduleRandomPope() {
            // Losujemy czas: od 5 minut (300 000 ms) do 45 minut (2 700 000 ms)
            // Dla test√≥w mo≈ºesz zmieniƒá na mniejsze liczby
            const minTime = 300000; 
            const maxTime = 2700000; 
            
            const randomDelay = Math.floor(Math.random() * (maxTime - minTime + 1)) + minTime;
            console.log(`Nastƒôpny losowy atak za: ${randomDelay / 1000} sekund`);

            setTimeout(triggerPope, randomDelay);
        }

        function triggerPope() {
            // Je≈õli akurat jest 21:37, to nie robimy "migniƒôcia", bo obraz i tak ma byƒá widoczny ciƒÖgle
            if (isPapalTime) {
                scheduleRandomPope(); // Pr√≥buj znowu p√≥≈∫niej
                return;
            }

            const img = document.getElementById('random-pope-img');
            
            // 1. Poka≈º (Jumpscare)
            img.style.display = 'block';

            // 2. Czekaj 2 sekundy i ukryj (chyba ≈ºe w miƒôdzyczasie wybi≈Ça 21:37)
            setTimeout(() => {
                if (!isPapalTime) {
                    img.style.display = 'none';
                }
                // 3. Zaplanuj kolejny atak
                scheduleRandomPope();
            }, 2000);
        }

        // Uruchom machinƒô losujƒÖcƒÖ po starcie
        scheduleRandomPope();


        // ==================================================
        // --- ZEGAR + LOGIKA 21:37 ---
        // ==================================================
        function updateTime() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            
            document.getElementById('clock').textContent = `${hours}:${minutes}`;
            const options = { weekday: 'long', day: 'numeric', month: 'long' };
            document.getElementById('date').textContent = now.toLocaleDateString('pl-PL', options);

            // --- SPRAWDZANIE GODZINY 21:37 ---
            const img = document.getElementById('random-pope-img');

            if (hours === '21' && minutes === '37') {
                // Je≈õli wybi≈Ça 21:37 i jeszcze nie w≈ÇƒÖczyli≈õmy trybu:
                if (!isPapalTime) {
                    isPapalTime = true;
                    img.style.display = 'block'; // Poka≈º na sta≈Çe
                }
            } else {
                // Je≈õli minƒô≈Ça 21:37 (jest np. 21:38) i tryb by≈Ç w≈ÇƒÖczony:
                if (isPapalTime) {
                    isPapalTime = false;
                    img.style.display = 'none'; // Ukryj
                }
            }
        }
        setInterval(updateTime, 1000);
        updateTime();

        // ==================================================
        // --- POGODA ---
        // ==================================================
        function getIcon(code) {
            if (code === 0) return "‚òÄÔ∏è";
            if (code >= 1 && code <= 3) return "üå•Ô∏è";
            if (code === 45 || code === 48) return "üå´Ô∏è";
            if (code >= 51 && code <= 57) return "üåßÔ∏è";
            if (code >= 61 && code <= 67) return "üåßÔ∏è";
            if (code >= 71 && code <= 77) return "‚ùÑÔ∏è";
            if (code >= 80 && code <= 82) return "üå¶Ô∏è";
            if (code === 85 || code === 86) return "üå®Ô∏è";
            if (code >= 95 && code <= 99) return "‚õàÔ∏è";
            return "üå°Ô∏è";
        }

        async function getWeather() {
            const url = 'https://api.open-meteo.com/v1/forecast?latitude=51.972&longitude=17.502&current_weather=true&daily=weathercode,temperature_2m_max,temperature_2m_min&timezone=Europe%2FWarsaw';
            try {
                const response = await fetch(url);
                const data = await response.json();
                
                const currentTemp = Math.round(data.current_weather.temperature);
                const currentCode = data.current_weather.weathercode;
                document.getElementById('weather-icon').textContent = getIcon(currentCode);
                document.getElementById('weather-text').innerHTML = `Jarocin: ${currentTemp}¬∞C`;

                const daily = data.daily;
                const container = document.getElementById('forecast-row');
                container.innerHTML = ""; 
                for(let i = 0; i <= 6; i++) {
                    const dateStr = daily.time[i];
                    const maxTemp = Math.round(daily.temperature_2m_max[i]);
                    const minTemp = Math.round(daily.temperature_2m_min[i]);
                    const code = daily.weathercode[i];
                    const dateObj = new Date(dateStr);
                    let dayName = dateObj.toLocaleDateString('pl-PL', { weekday: 'short' });
                    dayName = dayName.replace('.', '');

                    const dayHTML = `
                        <div class="day-card">
                            <div class="day-name">${dayName}</div>
                            <div class="day-icon">${getIcon(code)}</div>
                            <div class="day-temp">
                                ${maxTemp}¬∞<span>${minTemp}¬∞</span>
                            </div>
                        </div>
                    `;
                    container.innerHTML += dayHTML;
                }
            } catch (error) { console.log("B≈ÇƒÖd:", error); }
        }
        getWeather();
        setInterval(getWeather, 900000); 
    </script>
</body>
</html>
